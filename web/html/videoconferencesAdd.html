<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>设置</title>
  <link href="../css/reset.css" rel="stylesheet" type="text/css" />
  <link href="../css/main.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="../css/head.css" />
  <link rel="stylesheet" href="../css/select.css" />
  <script type="text/javascript" src="../js/jquery-1.8.0.min.js"></script>
  <script type="text/javascript" src="../js/main.js"></script>
  <script src="../js/audio.js"></script>

  <link rel="stylesheet" href="../css/zTreeStyle.css">

  <script src="../js/jquery.ztree.core.js"></script>
  <script src="../js/vue.min.js"></script>
  <script src="../js/vue-resource@1.3.4.js"></script>
  <script src="../js/lodash.min.js"></script>


  <link rel="stylesheet" href="../css/zTreeStyle.css">
  <script src="../js/jquery.ztree.core.js"></script>
  <script src="../js/jquery.ztree.exedit.js"></script>
  <script src="../js/jquery.ztree.excheck.js"></script>

  <script type="text/javascript" src="../js/jquery.ztree.exhide.js"></script>
  <script type="text/javascript" src="../js/jquery.ztree.fuzzysearch.js"></script>

  <script type="text/javascript" src="../js/jedate/jedate.js"></script>
  <link rel="stylesheet" href="../css/videoconferences.css">
</head>

<body>
  <!-- 页面遮罩层 layer -->
  <div class="layer"></div>
  <div class="layer-1"></div>
  <!-- 页面头部 header -->
  <div class="header">
    <h1 class="logo fl"></h1>
    <span class="mar fl">|</span>
    <span class="fl">
      <em>团队版</em>[
      <a href="">点击切换</a>]</span>
    <ul class="nav">
      <li>
        <a href="indexnew2.html">首页</a>
      </li>
      <!--<li>-->
      <!--<a href="">行动</a>-->
      <!--</li>-->
      <li>
        <a href="customer1.html">客户</a>
      </li>
      <li>
        <a href="download.html">线索</a>
      </li>
      <li>
        <a href="task.html">任务</a>
      </li>
      <li>
        <a href="robotTask.html">机器人</a>
      </li>
      <li>
        <a href="konwledge.html" class="current">办公</a>
      </li>
      <li>
        <a href="settings.html" id="top-setting">设置</a>
      </li>
    </ul>
    <ul class="header-right fr">
      <li>
        <a href="javascript:;">
          <i class="add"></i>
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <i class="update"></i>
        </a>
      </li>
      <li>
        <a href="javascript:;">
          <i class="message"></i>
        </a>
      </li>
      <li>
        <a href="javascript:;" class="user">刘</a>
      </li>
    </ul>
  </div>
  <!-- 汇总提示 tipArea -->
  <div class="tipArea">
    <div class="wrap">
      <ul class="ul-2">
        <li>
          <a href="konwledge.html">知识库</a>
        </li>
        <li>
          <a class="current">视频会议</a>
        </li>
      </ul>
    </div>
  </div>
  <!-- 内容部分 contents -->
  <div class="contents content-fixed" id="main">

    <div class="tag-box">
      <div class="tags-li ">
        <a href="videoconferencesRoom.html">我的会议室</a>
      </div>
      <div class="tags-li">
        <a href="videoconferences.html">会议室管理</a>
      </div>
      <div class="tags-li active">
        <a href="videoconferencesAdd.html">新增会议室</a>
      </div>
      <div class="tags-li">
        <a href="javascript:;">会议统计</a>
      </div>
    </div>
    <div class="video-main">
      <form class="konwledge-form-wrap">
        <div class=" form-row">
          <div class="form-name required">
            会议室名称
          </div>
          <div class="form-info"><input type="text" placeholder="请输入会议室名称" class="input-num" data-max="10"><label class="form-count">还可以输入
              <span>10</span>
              字</label></div>
        </div>
        <div class=" form-row">
          <div class="form-name">
            会议室主题
          </div>
          <div class="form-info"><input type="text" placeholder="请输入会议室主题" class="input-num" data-max="20"> <label
              class="form-count">还可以输入
              <span>20</span>
              字</label></div>
        </div>
        <div class=" form-row">
          <div class="form-name">
            会议开始日期
          </div>
          <div class="form-info">
            <div class="input-time">
              <input type="text" id="dateinput" class="input" placeholder="会议开始日期">
              <i class="icon-time"></i> <i class="icon-times" onclick="clearTime(this)">×</i>
            </div>
            <!-- <input type="text" placeholder="会议开始日期"> -->
          </div>
        </div>
        <div class=" form-row">
          <div class="form-name">
            会议开始时间
          </div>
          <div class="form-info">
            <div class="input-time">
              <input type="text" id="timeStart" class="input" placeholder="会议开始时间">
              <i class="icon-time"></i> <i class="icon-times" onclick="clearTime(this)">×</i>
            </div>
            <!-- <input type="text" placeholder="会议开始时间"> -->
          </div>
        </div>
        <div class=" form-row">
          <div class="form-name">
            会议结束时间
          </div>
          <div class="form-info">
            <div class="input-time">
              <input type="text" id="timeEnd" class="input" placeholder="会议结束时间">
              <i class="icon-time"></i> <i class="icon-times" onclick="clearTime(this)">×</i>
            </div>
            <!-- <input type="text" placeholder="会议结束时间"> -->
          </div>
        </div>
        <div class=" form-row">
          <div class="form-name">
            参会人员
          </div>
          <div class="form-info">
            <div class="select-person" onclick="layerShow('#selectPerson')"><span id="memberShip" class="memberShip"></span><span
                class="memberDefault">请选择</span>
              &gt;</div>
          </div>
        </div>
        <div class=" form-row">
          <div class="form-name">
            管理人员
          </div>
          <div class="form-info">
            <div class="select-person" onclick="layerShow('#selectManager')"><span id="manageShip" class="memberShip"></span><span
                class="memberDefault">请选择</span> &gt;</div>
          </div>
        </div>
        <div class=" form-row">
          <div class="form-name">
            重复周期
          </div>
          <div class="form-info" id="repeat-box">
            <div>
              <label class="radio-wrap">
                <input type="radio" name="repeat" value="0" checked>
                <i class="radio-icon"></i>
                <span>不重复</span>
              </label>
            </div>
            <div>
              <label class="radio-wrap">
                <input type="radio" name="repeat" value="1">
                <i class="radio-icon"></i>
                <span>每天</span>
              </label>
            </div>
            <div>
              <label class="radio-wrap">
                <input type="radio" name="repeat" value="2">
                <i class="radio-icon"></i>
                <span>每周</span>
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="repeatDay">
                <i></i>
                <span>周一</span>
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="repeatDay">
                <i></i>
                <span>周二</span>
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="repeatDay">
                <i></i>
                <span>周三</span>
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="repeatDay">
                <i></i>
                <span>周四</span>
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="repeatDay">
                <i></i>
                <span>周五</span>
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="repeatDay">
                <i></i>
                <span>周六</span>
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="repeatDay">
                <i></i>
                <span>周日</span>
              </label>
            </div>
            <div>
              <label class="radio-wrap">
                <input type="radio" name="repeat" value="3">
                <i class="radio-icon"></i>
                <span>每月</span>
              </label>
              <input type="text" class="repeatText">号
            </div>
          </div>
        </div>
        <div class=" form-row">
          <div class="form-name">
            提醒时间
          </div>
          <div class="form-info">
            <select id="remind">
              <option value="">无提醒</option>
              <option value="">准时提醒</option>
              <option value="">提前5分钟提醒</option>
              <option value="">提前15分钟提醒</option>
              <option value="">提前30分钟提醒</option>
            </select>
          </div>
        </div>
        <div class=" form-row">
          <div class="form-info"><input type="submit" value="创建会议室" class="btn"> </div>
        </div>
      </form>

    </div>
  </div>

  <div class="modal " id="selectPerson">
    <div class="modal-top">
      <i></i>选择参会人员
      <a href="javascript:layerClose('#selectPerson');" class="closed"></a>
    </div>
    <div class="modal-body">
      <div class="form-control form-default">
        <div class="form-info search-info">
          <input type="text" placeholder="请输入搜索关键字" class="input" id="searchDepart"> <i class="icon icon-search"></i>
        </div>
      </div>
      <label>已选择<span id="personCount">0</span>人</label>
      <div class="tags-wrap" id="departCheck">
      </div>
      <div class="tags-wrap" id="memberCheck">
      </div>
      <div class="index-checkbox">
        <label class="radio-label">
          <input type="radio" name="selectDepart" checked="" value="0">
          <i class="radio-icon"></i>
          选择部门
        </label>
        <label class="radio-label">
          <input type="radio" name="selectDepart" value="1">
          <i class="radio-icon"></i>
          选择参会人员
        </label>
      </div>
      <div class="ztree-depart video-ztree">
        <ul class="ztree department-tree" id="depart"></ul>
      </div>
    </div>
    <div class="modal-bottom">
      <input type="submit" class="btn" onclick="savePerson()" value="保存" />
      <input type="button" class="btn btn-cancel" onclick="layerClose('#selectPerson')" value="取消" />
    </div>
  </div>

  <div class="modal " id="selectManager">
    <div class="modal-top">
      <i></i>选择管理员
      <a href="javascript:layerClose('#selectManager');" class="closed"></a>
    </div>
    <div class="modal-body">
      <div class="form-control form-default">
        <div class="form-info search-info">
          <input type="text" placeholder="请输入搜索关键字" class="input"> <i class="icon icon-search"></i>
        </div>
      </div>
      <label>已选择<span id="manageCount">0</span>人</label>
      <div class="tags-wrap" id="manageCheck">
      </div>
      <div class="depart-wrap" id="manager-wrap">
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
        <div class="depart-box">
          <label class="checkbox-label">
            <input type="checkbox">
            <i></i>
            <div class="depart-member">
              <img src="../images/member.png" alt="">
              <div class="member-info">
                <span class="manage-name">张三</span>
                <span class="position">CEO</span>
              </div>
            </div>
          </label>
        </div>
      </div>
    </div>
    <div class="modal-bottom">
      <input type="submit" class="btn" onclick="saveManage()" value="保存" />
      <input type="button" class="btn btn-cancel" onclick="layerClose('#selectManager')" value="取消" />
    </div>
  </div>

  <script>
    //关闭弹框
    function layerClose(obj) {
      $(obj).hide();
      $(".layer").hide();
    }

    function layerShow(obj) {
      $(obj).show();
      $(".layer").show();
    }


    $(function () {
      $(".layer").click(function () {
        $(".modal").hide();
      });
      var time = {
        format: 'YYYY-MM-DD',
        // maxDate: $.nowDate(0), //设定最小日期为当前日期
        // minDate: '1900-01-01 00:00:00', //最大日期
        okfun: function (elem, datas) {

        }
      };
      var start = {
        format: 'hh:mm:ss',
        // maxDate: $.nowDate(0), //设定最小日期为当前日期
        minDate: '00:00:00', //最大日期
        okfun: function (elem, datas) {
          // console.log(datas);
          // end.minDate = datas; //开始日选好后，重置结束日的最小日期
        }
      };
      var end = {
        format: 'hh:mm:ss',
        // maxDate: $.nowDate(0), //设定最小日期为当前日期
        //  festival:true,
        minDate: '00:00:00', //最大日期
        okfun: function (elem, datas) {
          // console.log(datas);
          // start.maxDate = datas; //将结束日的初始值设定为开始日的最大日期
        }
      };
      $('#dateinput').jeDate(time);
      $('#timeStart').jeDate(start);
      $('#timeEnd').jeDate(end);

    });

    function clearTime(obj) {
      $(obj).parent().find("input").val("");
    }

    $(function () {

      repeatChange();
      $("#repeat-box input[name='repeat']").change(function () {
        console.log($(this).val());
        repeatChange($(this).val());
      });

      $(".input-num").on('input propertychange', function () {
        var num = $(this).data().max;
        var val = $(this).val().trim();
        if (num - val.length < 0) {
          $(this).val(val.substr(0, num));
        }
        $(this).next().find("span").text(num - $(this).val().trim().length);
      })
    });



    function repeatChange(val) {
      if (val == undefined) {
        val = 0;
      }
      repeatDefault();
      switch (val) {
        case '2':
          $("#repeat-box input[name=repeatDay]").removeAttr("disabled");
          break;
        case '3':
          $("#repeat-box .repeatText").removeAttr("readonly");
          break;
        default:
          break;
      }
    }

    function repeatDefault() {
      $("#repeat-box input[name=repeatDay]").attr("disabled", "disabled");
      $("#repeat-box .repeatText").attr("readonly", "readonly");
    }

    var settings = {
      check: {
        enable: true,
        chkboxType: {
          "Y": "s",
          "N": "s"
        }
      },
      data: {
        simpleData: {
          enable: true
        }
      },
      callback: {
        onMouseDown: onMouseDown,
        onCheck: onCheck
      }
    };

    function onMouseDown(event, treeId, treeNode) {
      //选中部门
      var treeObj = $.fn.zTree.getZTreeObj('depart');
      if (treeNode != null) {
        if (treeNode.getCheckStatus().checked == true) {
          treeObj.checkNode(treeNode, false, true, function () {});
        } else {
          treeObj.checkNode(treeNode, true, true, function () {});
        }
      }
    }

    var selectDeparts = [],
      selectUsers = [];
    var personCount = 0,
      departCount = 0;

    function onCheck(event, treeId, treeNode) {
      var treeObj = $.fn.zTree.getZTreeObj('depart');
      var nodes = treeObj.getCheckedNodes(true);
      if ($("input[name=selectDepart]:checked")[0].value == "0") {
        selectDeparts = appendCheck('depart', nodes, 'department');
      } else {
        selectUsers = appendCheck('member', nodes, 'user');
      }
    }

    //选择参会人
    function appendCheck(id, nodes, type) {
      $("#" + id + "Check").html("");
      type == "department" ? (departCount = 0) : (personCount = 0);
      var vals = [];
      for (var i = 0; i < nodes.length; i++) {
        if (nodes[i].flag == type) {
          $("#" + id + "Check").append('<span class="tags">' + (nodes[i].oldname != undefined ? nodes[i].oldname :
              nodes[i].name) +
            '<a href="javascript:;" onclick="deleteDepeart(this,\'' + id + '\',\'' + nodes[i].id +
            '\')" class="close">&times;</a></span>'
          );
          if (type == "department") {
            departCount += nodes[i].userNum;
          } else {
            personCount++;
          }
          vals.push(nodes[i]);
        }
      }
      personCountText();
      return vals;
    }

    //取消参会人
    function deleteDepeart(obj, type, id) {
      $(obj).parents(".tags").remove();
      var nodes = JSON.parse(JSON.stringify(type == 'depart' ? selectDeparts : selectUsers));
      var index = _.findIndex(nodes, function (o) {
        return o.id == id;
      })
      if (index >= 0) {
        if ((type == 'depart' && $("input[name=selectDepart]:checked")[0].value == "0") || (type == 'member' && $(
            "input[name=selectDepart]:checked")[0].value == "1")) {
          var zTree = $.fn.zTree.getZTreeObj("depart");
          var node = zTree.getNodeByTId(nodes[index].tId);
          if (node != null) {
            zTree.checkNode(node, false, false);

          }
        }
        if (type == 'depart') {
          departCount -= nodes[index].userNum;
        } else {
          personCount--;
        }
        personCountText();

        nodes.splice(index, 1);
        type == 'depart' ?
          (selectDeparts = JSON.parse(JSON.stringify(nodes))) : (selectUsers = JSON.parse(JSON.stringify(nodes)));
      }
    }

    //参会人统计
    function personCountText() {
      personCount = personCount < 0 ? 0 : personCount;
      departCount = departCount < 0 ? 0 : departCount;
      $("#personCount").text(personCount + departCount);
    }

    //保存选择参会人
    var persons = "";
    var personsArr = [];
    var depart = "";
    var departArr = [];

    function savePerson() {
      persons = "";
      personsArr = [];
      depart = "";
      departArr = [];
      for (var i = 0; i < selectDeparts.length; i++) {
        depart += selectDeparts[i].oldName;
        if (i < selectDeparts.length - 1) {
          depart += ",";
        }
        departArr.push({
          id: selectDeparts[i].id,
          name: selectDeparts[i].name
        });
      }
      for (var i = 0; i < selectUsers.length; i++) {
        persons += selectUsers[i].name;
        if (i < selectUsers.length - 1) {
          persons += ",";
        }
        personsArr.push({
          id: selectUsers[i].id,
          name: selectUsers[i].name
        });
      }
      Membership();
    }

    function Membership() {
      $("#memberShip").text(depart + (persons.length > 0 ? persons : ''));
      $("#memberShip").next().hide();

      if (persons == "" && depart == "") {
        $("#memberShip").next().show();
      }
      layerClose("#selectPerson");
    }

    $("body").on('change', 'input[name=selectDepart]', function () {
      changeZtree();
    });

    function changeZtree() {
      if ($("input[name=selectDepart]:checked")[0].value == "1") {
        settings.check.chkboxType = {
          "Y": "ps",
          "N": "ps"
        };
        setZtreeCheck('user');
      } else {
        settings.check.chkboxType = {
          "Y": "s",
          "N": "s"
        };
        setZtreeCheck('depart');
      }
    }
    //设置参会人
    function setZtreeCheck(type) {
      var nodes = [];
      nodes = type == 'depart' ? departzNodes : userzNodes;
      var vals = [];
      vals = type == 'depart' ? selectDeparts : selectUsers;
      for (var i = 0; i < nodes.length; i++) {
        var index = _.findIndex(vals, function (o) {
          return o.id == nodes[i].id;
        });
        if (index >= 0) {
          nodes[i]['checked'] = true;
        } else {
          nodes[i]['checked'] = false;
        }
      }
      var zTree = $.fn.zTree.init($("#depart"), settings, nodes);
      var nodesDefault = zTree.getNodesByFilter(function (node) {
        return node.level == 0 || node.level == 1
      });
      if (nodesDefault.length > 0) {
        zTree.expandNode(nodesDefault[0], true, false, false);
      }
    }

    var manageCount = 0;
    $(function () {
      $("#manager-wrap").on('change', 'input[type=checkbox]', function () {
        var obj = $(this);
        if (obj.attr("checked") == "checked") {
          $("#manageCheck").append('<span class="tags" data-id="' + obj.attr("id") +
            '" data-name="' + obj.parent().find(".manage-name").text() +
            '" >' + obj.parent().find(".manage-name").text() +
            '<a href="javascript:;" onclick="manageDelete(this)" data-index="' + obj.attr("id") +
            '" class="close">&times;</a></span>');
          manageCount++;
        } else {
          $("#manageCheck").find("a.close[data-index = " + obj.parents(".depart-box").attr('id') + "]").parents(
            ".tags").remove();
          manageCount--;
        }
        manageCountText();
      })
    });



    function manageDelete(obj) {
      var index = $(obj).data().index;
      $("#manager-wrap .depart-box:eq(" + index + ")").find("input[type=checkbox]").removeAttr("checked");
      $(obj).parents(".tags").remove();
      manageCount--;
      manageCountText();
    }

    var manages = "";
    var manageArr = [];

    function saveManage() {
      manages = "";
      mangeArr = [];
      var selectManage = $("#manageCheck").find(".tags");
      for (var i = 0; i < selectManage.length; i++) {
        manages += $(selectManage[i]).data().name;
        if (i < selectManage.length - 1) {
          manages += ",";
        }
        manageArr.push({
          id: $(selectManage[i]).data().id,
          name: $(selectManage[i]).data().name
        });
      }
      mangeShip();
    }

    function mangeShip() {
      $("#manageShip").text(manages);
      $("#manageShip").next().hide();

      if (manages == "") {
        $("#manageShip").next().show();
      }
      layerClose("#selectManager");
    }

    function manageCountText() {
      manageCount = manageCount < 0 ? 0 : manageCount;
      $("#manageCount").text(manageCount);
    }






    var zNodes = [{
      "id": "00D250B670B24F91A6F5BF271B922262",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "牟美娜",
      "flag": "user",
      "cellphone": "18410340049",
      "phone": 0,
      "imei": "",
      "headImg": "/2018/08big/32505cb7b04443e89d47594099f723bf_880ED69797CB498A89142406446CE26Aschedule-icon.png",
      "iconSkin": "normal",
      "userType": 0
    }, {
      "id": "00E18A8782A64F9F83459A03A2492340",
      "pId": "B44E5F5002E44CC6BBEE45A382BA6E9E",
      "name": "阶级",
      "flag": "user",
      "cellphone": "18901154881",
      "phone": 1,
      "imei": "867787035389182",
      "headImg": "/2018/08big/f4aafd886f3e4f30a9eb500aeb27046c_B476C127D3DD4732B4F98D28737865BDPhoto99e971a2-220b-44d6-a556-2a8b51d5d64d.jpg",
      "iconSkin": "normal",
      "userType": 0
    }, {
      "id": "025FE6CEB556485FB69AE2F5905F19B1",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "13078083843",
      "flag": "user",
      "cellphone": "13078083843",
      "phone": 0,
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "11BE4E702E114F9FA7735124A0E5C97B",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "销售2",
      "flag": "user",
      "cellphone": "18599999999",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "1389223EB08D45CAB40C4565F97706D7",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "13146816793",
      "flag": "user",
      "cellphone": "13146816793",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "1449D46A22454E9793F7D1F405DB753A",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "张伯阳",
      "flag": "user",
      "cellphone": "17612256497",
      "phone": 1,
      "imei": "867397032271464",
      "headImg": "/2018/06big/E772780684724B9F80FEC3E9046C0030Photo2bd84db9-2600-4f16-8c37-0683fcce2392.jpg",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2018/06big/E772780684724B9F80FEC3E9046C0030Photo2bd84db9-2600-4f16-8c37-0683fcce2392.jpg",
      "userType": 0
    }, {
      "id": "188F26F953B5411BAD01E2350A886C96",
      "pId": "3661BD8AABCC4CDE89D01FE852416101",
      "name": "陈博",
      "flag": "user",
      "cellphone": "15601313049",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "1E4644E6392C4541B11153CF21716EF0",
      "pId": "D784DD31CA634D299F5BD62EB68CDDC9",
      "name": "123",
      "flag": "user",
      "cellphone": "13716302192",
      "phone": 1,
      "imei": "868661033217134",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "21C805EDEE4844E39434BF49239898DF",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "13439660347",
      "flag": "user",
      "cellphone": "13439660347",
      "phone": 1,
      "imei": "867400020316622",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "21E89B99EE9F48D7992EF428D2D3676D",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "18811076155",
      "flag": "user",
      "cellphone": "18811076155",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "294B30BE68C24BC18D148F312440A394",
      "pId": "282D23A31C9C4AEFBAE6F1BDE8B90933",
      "name": "销售1",
      "flag": "user",
      "cellphone": "18734722387",
      "phone": 0,
      "imei": "",
      "headImg": "/2016/11big/58be86e6b7734f1094f6c14b041dc4b0_head.jpg",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2016/11big/58be86e6b7734f1094f6c14b041dc4b0_head.jpg",
      "userType": 0
    }, {
      "id": "30F60A32F57C40908E0939E05BAB6E8E",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "13522303798",
      "flag": "user",
      "cellphone": "13522303798",
      "phone": 1,
      "imei": "864105031571682",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "34B0F376BC944BA2A5C6C6FC5236266A",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "15112492385",
      "flag": "user",
      "cellphone": "15112492385",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "3F7AC24AAC2141F78E745AB119D0252F",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "张by",
      "flag": "user",
      "cellphone": "18511872523",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "44D4227BE98E449CA1ADA3E3BA7D5AC4",
      "pId": "2C398407E07744D9BF6A0323943D7ADE",
      "name": "ok",
      "flag": "user",
      "cellphone": "18703422799",
      "phone": 0,
      "imei": "",
      "headImg": "/2018/06big/E285F205BE9F4419A8B0AAECF7F97911Photo33d6edf2-4b79-4950-aa54-9485b248ff3b.jpg",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2018/06big/E285F205BE9F4419A8B0AAECF7F97911Photo33d6edf2-4b79-4950-aa54-9485b248ff3b.jpg",
      "userType": 2
    }, {
      "id": "54A05E302E9142F3B1E902389CDF4B48",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "18210234783",
      "flag": "user",
      "cellphone": "18210234783",
      "phone": 0,
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 2
    }, {
      "id": "57D2EA489E244FD39975C881A5C72880",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "贾琢",
      "flag": "user",
      "cellphone": "13439069006",
      "phone": 1,
      "imei": "351641091428512",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "5ABEE4F4F18F42D0B277BA018CF97206",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "17600976613",
      "flag": "user",
      "cellphone": "17600976613",
      "phone": 0,
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "5CB439185DE34C83AA29F876572F65D8",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "18513523390",
      "flag": "user",
      "cellphone": "18513523390",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "5CF21C78B7034AD482A20EA134D04717",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "苗辉",
      "flag": "user",
      "cellphone": "18911947785",
      "phone": 1,
      "imei": "867787033890207",
      "headImg": "/2018/08big/c7f28ca417af474d82152b4597dd52d3_A3E774A1F4C54666A2D9ECC7695A354Bcover.png",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2018/08big/c7f28ca417af474d82152b4597dd52d3_A3E774A1F4C54666A2D9ECC7695A354Bcover.png",
      "userType": 0
    }, {
      "id": "5FF90EE65B1F42CFBF3B7FFE3FA25B6A",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "电话",
      "flag": "user",
      "cellphone": "15602463426",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "7123C141DFAE445281781B97AC76CD5X",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "牟",
      "flag": "user",
      "cellphone": "13910803474",
      "phone": 1,
      "imei": "351641091428835",
      "headImg": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "8C78A98DA6424EDFADA62240F127E56E",
      "pId": "3661BD8AABCC4CDE89D01FE852416101",
      "name": "15703412808",
      "flag": "user",
      "cellphone": "15703412808",
      "phone": 1,
      "imei": "867397036869826",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "91909CF40FCC4BFCB6ED511FF96114D4",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "冯德林",
      "flag": "user",
      "cellphone": "18600755063",
      "phone": 0,
      "imei": "",
      "headImg": "/2018/04big/23782E614C9C44BCA50F04324F8C39F3c68313df-65d8-4182-85a2-3d11f2763386.jpg",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2018/04big/23782E614C9C44BCA50F04324F8C39F3c68313df-65d8-4182-85a2-3d11f2763386.jpg",
      "userType": 2
    }, {
      "id": "9C67E767094742DFBD342C9E2072AED5",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "刘晓辉",
      "flag": "user",
      "cellphone": "13699273847",
      "phone": 1,
      "imei": "358914060044799",
      "headImg": "/2017/10big/ab87919630a949eca2f0284c884766e0_head.jpg",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2017/10big/ab87919630a949eca2f0284c884766e0_head.jpg",
      "userType": 0
    }, {
      "id": "AEBDBABAC02D4755A37EB2631345B6E4",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "红米",
      "flag": "user",
      "cellphone": "13436457169",
      "phone": 1,
      "imei": "867397033384928",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 3
    }, {
      "id": "B8C315FDE5EE4AC7ADD2ADFF44424A6C",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "云客企业2762",
      "flag": "user",
      "cellphone": "18703422762",
      "phone": 0,
      "headImg": "/2018/03big/96972c35bdf04f989133505643921380_head.jpg",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2018/03big/96972c35bdf04f989133505643921380_head.jpg",
      "userType": 0
    }, {
      "id": "BD5A1AE8B5E6407B80CF2662BA60D7DA",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "15577746741",
      "flag": "user",
      "cellphone": "15577746741",
      "phone": 1,
      "imei": "358914060044997",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "C27D64A49FB64307A19AB77D2152B8B1",
      "pId": "D784DD31CA634D299F5BD62EB68CDDC9",
      "name": "贾鹏丽",
      "flag": "user",
      "cellphone": "15330273073",
      "phone": 1,
      "imei": "868947030209905",
      "headImg": "/2018/06big/7DFB93D9E70144DCB2F4035339540CABPhotoeb962fd8-ce29-4b16-bfe1-24a2fc92d383.jpg",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2018/06big/7DFB93D9E70144DCB2F4035339540CABPhotoeb962fd8-ce29-4b16-bfe1-24a2fc92d383.jpg",
      "userType": 0
    }, {
      "id": "C88C8EC1ABC1405B84E87B29B3420633",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "胡总",
      "flag": "user",
      "cellphone": "15167178752",
      "phone": 0,
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "D154B4F7E01B40B1B0FD64B33A5F4EFC",
      "pId": "3661BD8AABCC4CDE89D01FE852416101",
      "name": "销售3",
      "flag": "user",
      "cellphone": "18510611064",
      "phone": 0,
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "DB904379778D4948A770E5D01E1951D5",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "刘",
      "flag": "user",
      "cellphone": "17712345678",
      "phone": 1,
      "imei": "351641091428611",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 3
    }, {
      "id": "DC45A296D43F42F9A1BD5715FE6D8837",
      "pId": "3661BD8AABCC4CDE89D01FE852416101",
      "name": "15640444971",
      "flag": "user",
      "cellphone": "15640444971",
      "phone": 1,
      "imei": "868947030032943",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 2
    }, {
      "id": "E169C661ACD245119D5A1AF4DB436911",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "rena",
      "flag": "user",
      "cellphone": "13146869301",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "E53756C02755413C970150AB0EE6720D",
      "pId": "D784DD31CA634D299F5BD62EB68CDDC9",
      "name": "18012256575",
      "flag": "user",
      "cellphone": "18012256575",
      "phone": 1,
      "imei": "866764031311016",
      "headImg": "/2018/08big/07a00fb8fa1f4f1e87ad4a6afcafe049_EB50FE7653B34ECFACE6CA3882D3AC1Bcover.png",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2018/08big/07a00fb8fa1f4f1e87ad4a6afcafe049_EB50FE7653B34ECFACE6CA3882D3AC1Bcover.png",
      "userType": 0
    }, {
      "id": "E86DF88687CC40DD8F46DB5D29F7A9F3",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "17310666387",
      "flag": "user",
      "cellphone": "17310666387",
      "phone": 1,
      "imei": "358914060044948",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "E8B63FF5BB1840EABB9BEB2F9DCCA731",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "王克杰",
      "flag": "user",
      "cellphone": "18588883666",
      "phone": 0,
      "imei": "",
      "headImg": "/2018/06big/4F4BB4F18BC64CC7826F2E1C000BEF0DiOS_0.jpg",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2018/06big/4F4BB4F18BC64CC7826F2E1C000BEF0DiOS_0.jpg",
      "userType": 0
    }, {
      "id": "F19C41AAB897432F888726E6A864FB80",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "13041283801",
      "flag": "user",
      "cellphone": "13041283801",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "FBEDC571AF55426B9EAFE1E98E8ECD48",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "张洁",
      "flag": "user",
      "cellphone": "13426091878",
      "phone": 1,
      "imei": "867397030213526",
      "headImg": "/2018/02big/A59DF23D209B4C68A5F04F4C88979E6BiOS_0.jpg",
      "iconSkin": "normal",
      "icon": "http://yunkecn.com/fileupload/fileupload/2018/02big/A59DF23D209B4C68A5F04F4C88979E6BiOS_0.jpg",
      "userType": 2
    }, {
      "id": "FD804AAC8A294572855851275B723C45",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "微信",
      "flag": "user",
      "cellphone": "18703422763",
      "phone": 0,
      "imei": "",
      "iconSkin": "normal",
      "icon": "/pc/resources/images/member.png",
      "userType": 0
    }, {
      "id": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "pId": "",
      "name": "北京联云天下科技",
      "flag": "department",
      "userNum": 30
    }, {
      "id": "E2EAEDB79E734EA39F945DD0605B0291",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "测试",
      "flag": "department",
      "userNum": 10
    }, {
      "id": "3661BD8AABCC4CDE89D01FE852416101",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "销售一",
      "flag": "department",
      "userNum": 5
    }, {
      "id": "282D23A31C9C4AEFBAE6F1BDE8B90933",
      "pId": "3661BD8AABCC4CDE89D01FE852416101",
      "name": "销售1.1",
      "flag": "department",
      "userNum": 3
    }, {
      "id": "D784DD31CA634D299F5BD62EB68CDDC9",
      "pId": "282D23A31C9C4AEFBAE6F1BDE8B90933",
      "name": "销售1.1.1",
      "flag": "department",
      "userNum": 1
    }, {
      "id": "5D27AC61A1C34C649ABE55E55A886BCE",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "定位测试",
      "flag": "department",
      "userNum": 8
    }, {
      "id": "2C398407E07744D9BF6A0323943D7ADE",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "销售二部",
      "flag": "department",
      "userNum": 7
    }, {
      "id": "AB7333A26C2E4966BEBDAA5B7E6D1FF1",
      "pId": "5D27AC61A1C34C649ABE55E55A886BCE",
      "name": "测试1",
      "flag": "department",
      "userNum": 6
    }, {
      "id": "04CE1AFB49084AFD83B7954A04FDEE53",
      "pId": "AB7333A26C2E4966BEBDAA5B7E6D1FF1",
      "name": "测试1.1",
      "flag": "department",
      "userNum": 9
    }, {
      "id": "4514FBD7D8724FF384BF5C754202175E",
      "pId": "AB7333A26C2E4966BEBDAA5B7E6D1FF1",
      "name": "测试2",
      "flag": "department",
      "userNum": 2
    }, {
      "id": "B44E5F5002E44CC6BBEE45A382BA6E9E",
      "pId": "4514FBD7D8724FF384BF5C754202175E",
      "name": "测试2.1",
      "flag": "department",
      "userNum": 0
    }, {
      "id": "0FE683CC9E4D4EF1A17B2731A92F686C",
      "pId": "04CE1AFB49084AFD83B7954A04FDEE53",
      "name": "测试1.2",
      "flag": "department",
      "userNum": 1
    }, {
      "id": "78083BD43F3E47E49038AF6DED013A14",
      "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
      "name": "销售三部",
      "flag": "department",
      "userNum": 10
    }];
    var depart = [];
    for (var i = 0; i < zNodes.length; i++) {
      if (zNodes[i].flag == "department") {
        zNodes[i]['isParent'] = true;
        zNodes[i]['oldName'] = zNodes[i].name;
        zNodes[i]['name'] += ('(' + zNodes[i].userNum + '人)');
        depart.push(zNodes[i]);
      }
    }

    var userzNodes = JSON.parse(JSON.stringify(zNodes));
    var departzNodes = JSON.parse(JSON.stringify(depart));

    $.fn.zTree.init($("#depart"), settings, departzNodes);
    fuzzySearch('depart', '#searchDepart', null, true); //初始化模糊搜索方法
    changeZtree();

    $(function () {
      var departs = ["E2EAEDB79E734EA39F945DD0605B0291",
        "AB7333A26C2E4966BEBDAA5B7E6D1FF1", "0FE683CC9E4D4EF1A17B2731A92F686C",
        "4514FBD7D8724FF384BF5C754202175E", "B44E5F5002E44CC6BBEE45A382BA6E9E"
      ];

      var members = ["11BE4E702E114F9FA7735124A0E5C97B", "21C805EDEE4844E39434BF49239898DF",
        "30F60A32F57C40908E0939E05BAB6E8E"
      ];

      setPerson(departs, members);

    });

    function setPerson(departs, members) {
      var setDeparts = [];
      var setUsers = [];
      for (var i = 0; i < departs.length; i++) {
        var departIndex = _.findIndex(departzNodes, function (o) {
          return o.id == departs[i];
        });
        if (departIndex >= 0) {
          departzNodes[departIndex].checked = true;
          setDeparts.push(departzNodes[departIndex]);
        }
      }
      for (var i = 0; i < members.length; i++) {
        var memberIndex = _.findIndex(userzNodes, function (o) {
          return o.id == members[i];
        });
        if (memberIndex >= 0) {
          setUsers.push(userzNodes[memberIndex]);
        }
      }

      selectDeparts = appendCheck('depart', setDeparts, 'department');
      selectUsers = appendCheck('member', setUsers, 'user');
      settings.check.chkboxType = {
        "Y": "s",
        "N": "s"
      };
      setZtreeCheck('depart');
      savePerson();
    }

    setManage();

    function setManage() {
      var data = [{
        "id": "00D250B670B24F91A6F5BF271B922262",
        "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
        "name": "牟美娜",
        "flag": "user",
        "cellphone": "18410340049",
        "phone": 0,
        "imei": "",
        "headImg": "/2018/08big/32505cb7b04443e89d47594099f723bf_880ED69797CB498A89142406446CE26Aschedule-icon.png",
        "iconSkin": "normal",
        "userType": 0
      }, {
        "id": "1449D46A22454E9793F7D1F405DB753A",
        "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
        "name": "张伯阳",
        "flag": "user",
        "cellphone": "17612256497",
        "phone": 1,
        "imei": "867397032271464",
        "headImg": "/2018/06big/E772780684724B9F80FEC3E9046C0030Photo2bd84db9-2600-4f16-8c37-0683fcce2392.jpg",
        "iconSkin": "normal",
        "icon": "http://yunkecn.com/fileupload/fileupload/2018/06big/E772780684724B9F80FEC3E9046C0030Photo2bd84db9-2600-4f16-8c37-0683fcce2392.jpg",
        "userType": 0
      }, {
        "id": "188F26F953B5411BAD01E2350A886C96",
        "pId": "3661BD8AABCC4CDE89D01FE852416101",
        "name": "陈博",
        "flag": "user",
        "cellphone": "15601313049",
        "phone": 0,
        "imei": "",
        "iconSkin": "normal",
        "icon": "/pc/resources/images/member.png",
        "userType": 0
      }, {
        "id": "5CF21C78B7034AD482A20EA134D04717",
        "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
        "name": "苗辉",
        "flag": "user",
        "cellphone": "18911947785",
        "phone": 1,
        "imei": "867787033890207",
        "headImg": "/2018/08big/c7f28ca417af474d82152b4597dd52d3_A3E774A1F4C54666A2D9ECC7695A354Bcover.png",
        "iconSkin": "normal",
        "icon": "http://yunkecn.com/fileupload/fileupload/2018/08big/c7f28ca417af474d82152b4597dd52d3_A3E774A1F4C54666A2D9ECC7695A354Bcover.png",
        "userType": 0
      }, {
        "id": "91909CF40FCC4BFCB6ED511FF96114D4",
        "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
        "name": "冯德林",
        "flag": "user",
        "cellphone": "18600755063",
        "phone": 0,
        "imei": "",
        "headImg": "/2018/04big/23782E614C9C44BCA50F04324F8C39F3c68313df-65d8-4182-85a2-3d11f2763386.jpg",
        "iconSkin": "normal",
        "icon": "http://yunkecn.com/fileupload/fileupload/2018/04big/23782E614C9C44BCA50F04324F8C39F3c68313df-65d8-4182-85a2-3d11f2763386.jpg",
        "userType": 2
      }, {
        "id": "9C67E767094742DFBD342C9E2072AED5",
        "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
        "name": "刘晓辉",
        "flag": "user",
        "cellphone": "13699273847",
        "phone": 1,
        "imei": "358914060044799",
        "headImg": "/2017/10big/ab87919630a949eca2f0284c884766e0_head.jpg",
        "iconSkin": "normal",
        "icon": "http://yunkecn.com/fileupload/fileupload/2017/10big/ab87919630a949eca2f0284c884766e0_head.jpg",
        "userType": 0
      }, {
        "id": "AEBDBABAC02D4755A37EB2631345B6E4",
        "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
        "name": "红米",
        "flag": "user",
        "cellphone": "13436457169",
        "phone": 1,
        "imei": "867397033384928",
        "iconSkin": "normal",
        "icon": "/pc/resources/images/member.png",
        "userType": 3
      }, {
        "id": "C27D64A49FB64307A19AB77D2152B8B1",
        "pId": "D784DD31CA634D299F5BD62EB68CDDC9",
        "name": "贾鹏丽",
        "flag": "user",
        "cellphone": "15330273073",
        "phone": 1,
        "imei": "868947030209905",
        "headImg": "/2018/06big/7DFB93D9E70144DCB2F4035339540CABPhotoeb962fd8-ce29-4b16-bfe1-24a2fc92d383.jpg",
        "iconSkin": "normal",
        "icon": "http://yunkecn.com/fileupload/fileupload/2018/06big/7DFB93D9E70144DCB2F4035339540CABPhotoeb962fd8-ce29-4b16-bfe1-24a2fc92d383.jpg",
        "userType": 0
      }, {
        "id": "DB904379778D4948A770E5D01E1951D5",
        "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
        "name": "刘",
        "flag": "user",
        "cellphone": "17712345678",
        "phone": 1,
        "imei": "351641091428611",
        "iconSkin": "normal",
        "icon": "/pc/resources/images/member.png",
        "userType": 3
      }, {
        "id": "FBEDC571AF55426B9EAFE1E98E8ECD48",
        "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
        "name": "张洁",
        "flag": "user",
        "cellphone": "13426091878",
        "phone": 1,
        "imei": "867397030213526",
        "headImg": "/2018/02big/A59DF23D209B4C68A5F04F4C88979E6BiOS_0.jpg",
        "iconSkin": "normal",
        "icon": "http://yunkecn.com/fileupload/fileupload/2018/02big/A59DF23D209B4C68A5F04F4C88979E6BiOS_0.jpg",
        "userType": 2
      }, {
        "id": "FD804AAC8A294572855851275B723C45",
        "pId": "0FCEF72742CC4AA6ADF6F0238D65A38B",
        "name": "微信",
        "flag": "user",
        "cellphone": "18703422763",
        "phone": 0,
        "imei": "",
        "iconSkin": "normal",
        "icon": "/pc/resources/images/member.png",
        "userType": 0
      }];
      $("#manager-wrap").html('');
      for (var i = 0; i < data.length; i++) {
        $("#manager-wrap").append('<div class="depart-box">' +
          '<label class="checkbox-label">' +
          '<input type="checkbox" value="' + data[i].id + '">' +
          '            <i></i>' +
          '            <div class="depart-member">' +
          '<img src="' + data[i].icon + '" alt="">' +
          '              <div class="member-info">' +
          '<span class="manage-name">' + data[i].name + '</span>' +
          '                <span class="position">' + data[i].flag + '</span>' +
          '</div>' +
          '</div>' +
          '</label>' +
          '</div>');
      }

      getManageNames(data);
    }

    function getManageNames(data) {
      var managers = ['FBEDC571AF55426B9EAFE1E98E8ECD48', 'FD804AAC8A294572855851275B723C45'];
      for (var i = 0; i < managers.length; i++) {
        var index = _.findIndex(data, function (o) {
          return o.id == managers[i];
        })
        if (index >= 0) {
          $("#manageCheck").append('<span class="tags" data-id="' + data[index].id +
            '" data-name="' + data[index].name +
            '" >' + data[index].name +
            '<a href="javascript:;" onclick="manageDelete(this)" data-index="' + data[index].id +
            '" class="close">&times;</a></span>');
          manageCount++;
        }
        $("#manager-wrap").find('input[type="checkbox"][value="' + managers[i] + '"]').attr("checked", "checked");
      }
      manageCountText();

      saveManage();
    }
  </script>
</body>

</html>